{% extends '/panel/page.html.twig' %}
{% block content %}
    <div class="m-4">
        <div class="col-sm-4">
            <a href="{{ path('app_specialists_new') }}" class="btn btn-success my-2">Add new</a>
        </div>
        <h1>Specialists</h1>
        {% for flat in flats %}
            <div class="row">
                <div class="card col-sm-3 m-3 p-0 border-0" id="flat-{{ flat.id }}">
                    <figure>
                        {% if flat.pictures %}
                            <img class="card-img-top" src="/uploads/flats/pictures/user{{ flat.landlord.id  }}/{{ flat.pictures|first }}" alt="{{ flat.address }}">
                        {% endif %}
                    </figure>
                    <div class="card-body">
                        <h5 class="card-title text-secondary">{{ flat.address }}, {{ flat.area }} m<sup>2</sup>, {{ flat.rent }}z≈Ç&nbsp;&nbsp;<a href="{{ path('app_flats_view', {id: flat.id}) }}"><i class="fa-solid fa-up-right-from-square"></i></a> </h5>
                        <p class="card-text">{{ (flat.description|length > 100 ? flat.description|slice(0, 100) ~ '...': flat.description) | striptags}}</p>
                    </div>
                </div>
            </div>
            <div class="row">
                {% for specialist in flat.specialists %}
                    <div class="card col-sm-3 m-3 p-0 border-0" id="specialist-{{ specialist.id }}">
                        <div class="card-body">
                            <h5 class="card-title text-secondary text-center">
                                {{ specialist.name }}<br>
                                <small style="font-weight: lighter;">{{ specialist.profession }}</small>
                            </h5>
                            <div class="specialist-contact">
                                {% if specialist.phone %}
                                    <a href="tel:{{ specialist.phone }}">{{ specialist.phone }}</a> <br>
                                {% endif %}
                                {% if specialist.email %}
                                    <a href="mailto:{{ specialist.email }}">{{ specialist.email }}</a> <br>
                                {% endif %}
                                {% if specialist.address %}
                                    {{ specialist.address }}
                                {% endif %}
                            </div>
                            {% if specialist.note %}
                                <hr>
                                <p class="card-text">{{ specialist.note }}</p>
                            {% endif %}
                            {% if specialist.gmb %}
                                <hr>
                                <iframe src="{{ specialist.gmb }}" width="600" height="450" style="border:0; max-width: 100%;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                            {% endif %}
                        </div>
                        <a class="btn btn-success" href="{{ path('app_specialists_view', {id: specialist.id}) }}">See more</a>
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
{% endblock %}